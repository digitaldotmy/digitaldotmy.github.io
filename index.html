<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>EPG Display</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xml2json/1.0.2/xml2json.min.js"></script>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th>Channel</th>
        <th>Program</th>
        <th>Start Time</th>
        <th>End Time</th>
      </tr>
    </thead>
    <tbody id="epg-body">
    </tbody>
  </table>
  <script>
    // Fetch the XML file and convert it to JSON
    $.ajax({
      url: 'https://raw.githubusercontent.com/AqFad2811/epg/main/epg.xml',
      dataType: 'xml',
      success: function(xml) {
        var json = $.xml2json(xml);

        // Parse the JSON data and create table rows
        var epgBody = $('#epg-body');
        $(json.channel).each(function(i, channel) {
          $(channel.programme).each(function(j, programme) {
            var startTime = new Date(programme.start).toLocaleTimeString();
            var endTime = new Date(programme.stop).toLocaleTimeString();
            var row = '<tr>' +
              '<td>' + channel.display_name + '</td>' +
              '<td>' + programme.title + '</td>' +
              '<td>' + startTime + '</td>' +
              '<td>' + endTime + '</td>' +
              '</tr>';
            epgBody.append(row);
          });
        });
      },
      error: function(xhr, status, error) {
        console.log('Failed to fetch EPG data:', error);
      }
    });
  </script>
</body>
</html>
